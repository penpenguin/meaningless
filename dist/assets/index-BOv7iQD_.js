var st=Object.defineProperty;var at=(b,n,o)=>n in b?st(b,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):b[n]=o;var c=(b,n,o)=>at(b,typeof n!="symbol"?n+"":n,o);import{E as rt,V as h,M as j,T as N,S as xe,Q as Pe,a as M,R as ct,P as lt,b as ht,O as dt,C as F,G as Re,c as mt,I as ut,D as pt,d as ft,e as gt,f as yt,g as Te,B as je,h as Ne,i as Fe,j as Ye,k as Q,l as bt,m as wt,n as ke,o as V,A as Mt,p as Et,q as vt,r as St,s as xt,W as Pt,t as Tt,u as kt,v as At,w as Lt,x as Ae,y as zt,z as Le,F as ze,H as Oe}from"./three-DvUyIlOC.js";import{l as Ot}from"./lottie-D_akyxJo.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&e(d)}).observe(document,{childList:!0,subtree:!0});function o(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(i){if(i.ep)return;i.ep=!0;const s=o(i);fetch(i.href,s)}})();const De={type:"change"},ie={type:"start"},Ce={type:"end"},q=new ct,Ie=new lt,Dt=Math.cos(70*ht.DEG2RAD);class Ct extends rt{constructor(n,o){super(),this.object=n,this.domElement=o,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new h,this.cursor=new h,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:j.ROTATE,MIDDLE:j.DOLLY,RIGHT:j.PAN},this.touches={ONE:N.ROTATE,TWO:N.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return r.phi},this.getAzimuthalAngle=function(){return r.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",oe),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",oe),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(De),e.update(),s=i.NONE},this.update=function(){const t=new h,a=new Pe().setFromUnitVectors(n.up,new h(0,1,0)),l=a.clone().invert(),m=new h,y=new Pe,k=new h,w=2*Math.PI;return function(it=null){const Se=e.object.position;t.copy(Se).sub(e.target),t.applyQuaternion(a),r.setFromVector3(t),e.autoRotate&&s===i.NONE&&_(_e(it)),e.enableDamping?(r.theta+=u.theta*e.dampingFactor,r.phi+=u.phi*e.dampingFactor):(r.theta+=u.theta,r.phi+=u.phi);let x=e.minAzimuthAngle,P=e.maxAzimuthAngle;isFinite(x)&&isFinite(P)&&(x<-Math.PI?x+=w:x>Math.PI&&(x-=w),P<-Math.PI?P+=w:P>Math.PI&&(P-=w),x<=P?r.theta=Math.max(x,Math.min(P,r.theta)):r.theta=r.theta>(x+P)/2?Math.max(x,r.theta):Math.min(P,r.theta)),r.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,r.phi)),r.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(f,e.dampingFactor):e.target.add(f),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor),e.zoomToCursor&&B||e.object.isOrthographicCamera?r.radius=te(r.radius):r.radius=te(r.radius*p),t.setFromSpherical(r),t.applyQuaternion(l),Se.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(u.theta*=1-e.dampingFactor,u.phi*=1-e.dampingFactor,f.multiplyScalar(1-e.dampingFactor)):(u.set(0,0,0),f.set(0,0,0));let Z=!1;if(e.zoomToCursor&&B){let U=null;if(e.object.isPerspectiveCamera){const W=t.length();U=te(W*p);const X=W-U;e.object.position.addScaledVector(se,X),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const W=new h(T.x,T.y,0);W.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/p)),e.object.updateProjectionMatrix(),Z=!0;const X=new h(T.x,T.y,0);X.unproject(e.object),e.object.position.sub(X).add(W),e.object.updateMatrixWorld(),U=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;U!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(U).add(e.object.position):(q.origin.copy(e.object.position),q.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(q.direction))<Dt?n.lookAt(e.target):(Ie.setFromNormalAndCoplanarPoint(e.object.up,e.target),q.intersectPlane(Ie,e.target))))}else e.object.isOrthographicCamera&&(Z=p!==1,Z&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/p)),e.object.updateProjectionMatrix()));return p=1,B=!1,Z||m.distanceToSquared(e.object.position)>d||8*(1-y.dot(e.object.quaternion))>d||k.distanceToSquared(e.target)>0?(e.dispatchEvent(De),m.copy(e.object.position),y.copy(e.object.quaternion),k.copy(e.target),!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Ee),e.domElement.removeEventListener("pointerdown",ye),e.domElement.removeEventListener("pointercancel",H),e.domElement.removeEventListener("wheel",be),e.domElement.removeEventListener("pointermove",ne),e.domElement.removeEventListener("pointerup",H),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",oe),e._domElementKeyEvents=null)};const e=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=i.NONE;const d=1e-6,r=new xe,u=new xe;let p=1;const f=new h,v=new M,S=new M,E=new M,A=new M,L=new M,O=new M,D=new M,C=new M,z=new M,se=new h,T=new M;let B=!1;const g=[],Y={};let $=!1;function _e(t){return t!==null?2*Math.PI/60*e.autoRotateSpeed*t:2*Math.PI/60/60*e.autoRotateSpeed}function K(t){const a=Math.abs(t*.01);return Math.pow(.95,e.zoomSpeed*a)}function _(t){u.theta-=t}function G(t){u.phi-=t}const ae=function(){const t=new h;return function(l,m){t.setFromMatrixColumn(m,0),t.multiplyScalar(-l),f.add(t)}}(),re=function(){const t=new h;return function(l,m){e.screenSpacePanning===!0?t.setFromMatrixColumn(m,1):(t.setFromMatrixColumn(m,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(l),f.add(t)}}(),I=function(){const t=new h;return function(l,m){const y=e.domElement;if(e.object.isPerspectiveCamera){const k=e.object.position;t.copy(k).sub(e.target);let w=t.length();w*=Math.tan(e.object.fov/2*Math.PI/180),ae(2*l*w/y.clientHeight,e.object.matrix),re(2*m*w/y.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(ae(l*(e.object.right-e.object.left)/e.object.zoom/y.clientWidth,e.object.matrix),re(m*(e.object.top-e.object.bottom)/e.object.zoom/y.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function J(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?p/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ce(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?p*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ee(t,a){if(!e.zoomToCursor)return;B=!0;const l=e.domElement.getBoundingClientRect(),m=t-l.left,y=a-l.top,k=l.width,w=l.height;T.x=m/k*2-1,T.y=-(y/w)*2+1,se.set(T.x,T.y,1).unproject(e.object).sub(e.object.position).normalize()}function te(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function le(t){v.set(t.clientX,t.clientY)}function He(t){ee(t.clientX,t.clientX),D.set(t.clientX,t.clientY)}function he(t){A.set(t.clientX,t.clientY)}function Ue(t){S.set(t.clientX,t.clientY),E.subVectors(S,v).multiplyScalar(e.rotateSpeed);const a=e.domElement;_(2*Math.PI*E.x/a.clientHeight),G(2*Math.PI*E.y/a.clientHeight),v.copy(S),e.update()}function We(t){C.set(t.clientX,t.clientY),z.subVectors(C,D),z.y>0?J(K(z.y)):z.y<0&&ce(K(z.y)),D.copy(C),e.update()}function Be(t){L.set(t.clientX,t.clientY),O.subVectors(L,A).multiplyScalar(e.panSpeed),I(O.x,O.y),A.copy(L),e.update()}function Ke(t){ee(t.clientX,t.clientY),t.deltaY<0?ce(K(t.deltaY)):t.deltaY>0&&J(K(t.deltaY)),e.update()}function Ge(t){let a=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?G(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(0,e.keyPanSpeed),a=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?G(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(0,-e.keyPanSpeed),a=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?_(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(e.keyPanSpeed,0),a=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?_(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(-e.keyPanSpeed,0),a=!0;break}a&&(t.preventDefault(),e.update())}function de(t){if(g.length===1)v.set(t.pageX,t.pageY);else{const a=R(t),l=.5*(t.pageX+a.x),m=.5*(t.pageY+a.y);v.set(l,m)}}function me(t){if(g.length===1)A.set(t.pageX,t.pageY);else{const a=R(t),l=.5*(t.pageX+a.x),m=.5*(t.pageY+a.y);A.set(l,m)}}function ue(t){const a=R(t),l=t.pageX-a.x,m=t.pageY-a.y,y=Math.sqrt(l*l+m*m);D.set(0,y)}function Ze(t){e.enableZoom&&ue(t),e.enablePan&&me(t)}function Xe(t){e.enableZoom&&ue(t),e.enableRotate&&de(t)}function pe(t){if(g.length==1)S.set(t.pageX,t.pageY);else{const l=R(t),m=.5*(t.pageX+l.x),y=.5*(t.pageY+l.y);S.set(m,y)}E.subVectors(S,v).multiplyScalar(e.rotateSpeed);const a=e.domElement;_(2*Math.PI*E.x/a.clientHeight),G(2*Math.PI*E.y/a.clientHeight),v.copy(S)}function fe(t){if(g.length===1)L.set(t.pageX,t.pageY);else{const a=R(t),l=.5*(t.pageX+a.x),m=.5*(t.pageY+a.y);L.set(l,m)}O.subVectors(L,A).multiplyScalar(e.panSpeed),I(O.x,O.y),A.copy(L)}function ge(t){const a=R(t),l=t.pageX-a.x,m=t.pageY-a.y,y=Math.sqrt(l*l+m*m);C.set(0,y),z.set(0,Math.pow(C.y/D.y,e.zoomSpeed)),J(z.y),D.copy(C);const k=(t.pageX+a.x)*.5,w=(t.pageY+a.y)*.5;ee(k,w)}function Ve(t){e.enableZoom&&ge(t),e.enablePan&&fe(t)}function qe(t){e.enableZoom&&ge(t),e.enableRotate&&pe(t)}function ye(t){e.enabled!==!1&&(g.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",ne),e.domElement.addEventListener("pointerup",H)),nt(t),t.pointerType==="touch"?Me(t):Qe(t))}function ne(t){e.enabled!==!1&&(t.pointerType==="touch"?tt(t):$e(t))}function H(t){switch(ot(t),g.length){case 0:e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",ne),e.domElement.removeEventListener("pointerup",H),e.dispatchEvent(Ce),s=i.NONE;break;case 1:const a=g[0],l=Y[a];Me({pointerId:a,pageX:l.x,pageY:l.y});break}}function Qe(t){let a;switch(t.button){case 0:a=e.mouseButtons.LEFT;break;case 1:a=e.mouseButtons.MIDDLE;break;case 2:a=e.mouseButtons.RIGHT;break;default:a=-1}switch(a){case j.DOLLY:if(e.enableZoom===!1)return;He(t),s=i.DOLLY;break;case j.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;he(t),s=i.PAN}else{if(e.enableRotate===!1)return;le(t),s=i.ROTATE}break;case j.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;le(t),s=i.ROTATE}else{if(e.enablePan===!1)return;he(t),s=i.PAN}break;default:s=i.NONE}s!==i.NONE&&e.dispatchEvent(ie)}function $e(t){switch(s){case i.ROTATE:if(e.enableRotate===!1)return;Ue(t);break;case i.DOLLY:if(e.enableZoom===!1)return;We(t);break;case i.PAN:if(e.enablePan===!1)return;Be(t);break}}function be(t){e.enabled===!1||e.enableZoom===!1||s!==i.NONE||(t.preventDefault(),e.dispatchEvent(ie),Ke(Je(t)),e.dispatchEvent(Ce))}function Je(t){const a=t.deltaMode,l={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(a){case 1:l.deltaY*=16;break;case 2:l.deltaY*=100;break}return t.ctrlKey&&!$&&(l.deltaY*=10),l}function et(t){t.key==="Control"&&($=!0,e.domElement.getRootNode().addEventListener("keyup",we,{passive:!0,capture:!0}))}function we(t){t.key==="Control"&&($=!1,e.domElement.getRootNode().removeEventListener("keyup",we,{passive:!0,capture:!0}))}function oe(t){e.enabled===!1||e.enablePan===!1||Ge(t)}function Me(t){switch(ve(t),g.length){case 1:switch(e.touches.ONE){case N.ROTATE:if(e.enableRotate===!1)return;de(t),s=i.TOUCH_ROTATE;break;case N.PAN:if(e.enablePan===!1)return;me(t),s=i.TOUCH_PAN;break;default:s=i.NONE}break;case 2:switch(e.touches.TWO){case N.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ze(t),s=i.TOUCH_DOLLY_PAN;break;case N.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Xe(t),s=i.TOUCH_DOLLY_ROTATE;break;default:s=i.NONE}break;default:s=i.NONE}s!==i.NONE&&e.dispatchEvent(ie)}function tt(t){switch(ve(t),s){case i.TOUCH_ROTATE:if(e.enableRotate===!1)return;pe(t),e.update();break;case i.TOUCH_PAN:if(e.enablePan===!1)return;fe(t),e.update();break;case i.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ve(t),e.update();break;case i.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;qe(t),e.update();break;default:s=i.NONE}}function Ee(t){e.enabled!==!1&&t.preventDefault()}function nt(t){g.push(t.pointerId)}function ot(t){delete Y[t.pointerId];for(let a=0;a<g.length;a++)if(g[a]==t.pointerId){g.splice(a,1);return}}function ve(t){let a=Y[t.pointerId];a===void 0&&(a=new M,Y[t.pointerId]=a),a.set(t.pageX,t.pageY)}function R(t){const a=t.pointerId===g[0]?g[1]:g[0];return Y[a]}e.domElement.addEventListener("contextmenu",Ee),e.domElement.addEventListener("pointerdown",ye),e.domElement.addEventListener("pointercancel",H),e.domElement.addEventListener("wheel",be,{passive:!1}),e.domElement.getRootNode().addEventListener("keydown",et,{passive:!0,capture:!0}),this.update()}}class It{constructor(n,o,e){c(this,"position");c(this,"velocity");c(this,"acceleration");c(this,"maxSpeed");c(this,"maxForce");this.position=new h(n,o,e),this.velocity=new h((Math.random()-.5)*2,(Math.random()-.5)*2,(Math.random()-.5)*2),this.acceleration=new h,this.maxSpeed=.5,this.maxForce=.03}applyForce(n){this.acceleration.add(n)}seek(n){const o=new h().subVectors(n,this.position);o.normalize(),o.multiplyScalar(this.maxSpeed);const e=new h().subVectors(o,this.velocity);return e.clampLength(0,this.maxForce),e}flee(n){const o=new h().subVectors(this.position,n);o.normalize(),o.multiplyScalar(this.maxSpeed);const e=new h().subVectors(o,this.velocity);return e.clampLength(0,this.maxForce),e}update(){this.velocity.add(this.acceleration),this.velocity.clampLength(0,this.maxSpeed),this.position.add(this.velocity),this.acceleration.multiplyScalar(0)}}class Rt{constructor(n,o){c(this,"boids");c(this,"params");c(this,"bounds");this.boids=[],this.bounds=o,this.params={alignment:1,cohesion:.8,separation:1.5,maxSpeed:.5,maxForce:.03,neighborRadius:2};const e=new h;o.getSize(e);const i=new h;o.getCenter(i);for(let s=0;s<n;s++){const d=i.x+(Math.random()-.5)*e.x*.8,r=i.y+(Math.random()-.5)*e.y*.8,u=i.z+(Math.random()-.5)*e.z*.8,p=new It(d,r,u);p.maxSpeed=this.params.maxSpeed,p.maxForce=this.params.maxForce,this.boids.push(p)}}alignment(n,o){const e=new h;if(o.length===0)return e;for(const s of o)e.add(s.velocity);e.divideScalar(o.length),e.normalize(),e.multiplyScalar(n.maxSpeed);const i=new h().subVectors(e,n.velocity);return i.clampLength(0,n.maxForce),i}cohesion(n,o){const e=new h;if(o.length===0)return e;for(const i of o)e.add(i.position);return e.divideScalar(o.length),n.seek(e)}separation(n,o){const e=new h;for(const i of o){const s=n.position.distanceTo(i.position);if(s>0&&s<1){const d=new h().subVectors(n.position,i.position);d.normalize(),d.divideScalar(s),e.add(d)}}return o.length>0&&e.divideScalar(o.length),e.length()>0&&(e.normalize(),e.multiplyScalar(n.maxSpeed),e.sub(n.velocity),e.clampLength(0,n.maxForce)),e}boundaries(n){const o=new h,e=1;return n.position.x<this.bounds.min.x+e?o.x=n.maxSpeed:n.position.x>this.bounds.max.x-e&&(o.x=-n.maxSpeed),n.position.y<this.bounds.min.y+e?o.y=n.maxSpeed:n.position.y>this.bounds.max.y-e&&(o.y=-n.maxSpeed),n.position.z<this.bounds.min.z+e?o.z=n.maxSpeed:n.position.z>this.bounds.max.z-e&&(o.z=-n.maxSpeed),o}getNeighbors(n){const o=[];for(const e of this.boids)e!==n&&n.position.distanceTo(e.position)<this.params.neighborRadius&&o.push(e);return o}update(){for(const n of this.boids){const o=this.getNeighbors(n),e=this.alignment(n,o),i=this.cohesion(n,o),s=this.separation(n,o),d=this.boundaries(n);e.multiplyScalar(this.params.alignment),i.multiplyScalar(this.params.cohesion),s.multiplyScalar(this.params.separation),d.multiplyScalar(2),n.applyForce(e),n.applyForce(i),n.applyForce(s),n.applyForce(d),n.update()}}}class jt{constructor(n,o){c(this,"group");c(this,"instancedMesh");c(this,"boids");c(this,"fishCount");c(this,"dummy",new dt);c(this,"color",new F);this.group=new Re,n.add(this.group);const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);this.fishCount=e?50:100,this.boids=new Rt(this.fishCount,o),this.createFishMesh()}createFishMesh(){const n=this.createFishGeometry(),o=new mt({color:16739125,emissive:3349005,emissiveIntensity:.1,shininess:100,specular:16777215,vertexColors:!0});this.instancedMesh=new ut(n,o,this.fishCount),this.instancedMesh.instanceMatrix.setUsage(pt),this.instancedMesh.castShadow=!0,this.instancedMesh.receiveShadow=!0;const e=new Float32Array(this.fishCount*3),i=[new F(16739125),new F(16753920),new F(16764220),new F(16747586),new F(16766720)];for(let s=0;s<this.fishCount;s++){const d=Math.floor(Math.random()*i.length),r=i[d],u={h:0,s:0,l:0};r.getHSL(u),this.color.setHSL(u.h+(Math.random()-.5)*.1,u.s+(Math.random()-.5)*.2,u.l+(Math.random()-.5)*.2),e[s*3]=this.color.r,e[s*3+1]=this.color.g,e[s*3+2]=this.color.b}this.instancedMesh.instanceColor=new ft(e,3),this.group.add(this.instancedMesh)}createFishGeometry(){const n=new gt;n.moveTo(0,0),n.quadraticCurveTo(.3,.15,.6,.1),n.quadraticCurveTo(.8,.05,1,0),n.quadraticCurveTo(.8,-.05,.6,-.1),n.quadraticCurveTo(.3,-.15,0,0);const o={depth:.2,bevelEnabled:!0,bevelSegments:2,steps:1,bevelSize:.02,bevelThickness:.02},e=new yt(n,o);e.center();const i=new Te(.15,.4,4);i.rotateZ(Math.PI/2),i.translate(-.6,0,0);const s=new Te(.1,.2,3);s.rotateZ(-Math.PI/2),s.rotateY(Math.PI/4),s.translate(.2,.1,.1),s.clone().translate(0,-.2,-.2);const r=new je;return r.setAttribute("position",e.getAttribute("position")),r.setAttribute("normal",e.getAttribute("normal")),r.setIndex(e.getIndex()),r}update(n,o){this.boids.update();for(let e=0;e<this.fishCount;e++){const i=this.boids.boids[e];this.dummy.position.copy(i.position);const s=i.velocity.clone().normalize();s.length()>0&&this.dummy.lookAt(i.position.x+s.x,i.position.y+s.y,i.position.z+s.z);const d=Math.sin(o*5+e)*.1;this.dummy.rotation.z+=d;const r=.8+Math.random()*.4;this.dummy.scale.set(r,r,r),this.dummy.updateMatrix(),this.instancedMesh.setMatrixAt(e,this.dummy.matrix)}this.instancedMesh.instanceMatrix.needsUpdate=!0}setMotionEnabled(n){if(!n)for(const o of this.boids.boids)o.velocity.multiplyScalar(0),o.acceleration.multiplyScalar(0)}}var Nt=`varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 vNormal;

uniform float time;

void main() {
  vUv = uv;
  
  vec3 pos = position;
  float wave = sin(pos.x * 2.0 + time) * 0.05 + sin(pos.z * 3.0 + time * 1.5) * 0.03;
  pos.y += wave;
  
  vec4 worldPosition = modelMatrix * vec4(pos, 1.0);
  vWorldPosition = worldPosition.xyz;
  vNormal = normalize(normalMatrix * normal);
  
  gl_Position = projectionMatrix * viewMatrix * worldPosition;
}`,Ft=`varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 vNormal;

uniform float time;
uniform sampler2D normalMap;
uniform vec3 cameraPosition;

void main() {
  vec2 normalUv1 = vUv * 3.0 + vec2(time * 0.02, time * 0.01);
  vec2 normalUv2 = vUv * 2.0 - vec2(time * 0.01, time * 0.02);
  
  vec3 normal1 = texture2D(normalMap, normalUv1).xyz * 2.0 - 1.0;
  vec3 normal2 = texture2D(normalMap, normalUv2).xyz * 2.0 - 1.0;
  vec3 combinedNormal = normalize(normal1 + normal2);
  
  vec3 viewDirection = normalize(cameraPosition - vWorldPosition);
  vec3 reflectedDirection = reflect(-viewDirection, combinedNormal);
  
  float fresnel = pow(1.0 - dot(viewDirection, combinedNormal), 2.0);
  
  vec3 waterColor = vec3(0.1, 0.3, 0.4);
  vec3 surfaceColor = vec3(0.4, 0.7, 0.8);
  
  vec3 color = mix(waterColor, surfaceColor, fresnel);
  
  float specular = pow(max(dot(reflectedDirection, vec3(0.0, 1.0, 0.0)), 0.0), 32.0);
  color += vec3(specular) * 0.5;
  
  gl_FragColor = vec4(color, 0.8);
}`;class Yt{constructor(n,o,e,i){c(this,"mesh");c(this,"material");const s=new Ne(o*.98,e*.98,32,32),d=this.createNormalMap();this.material=new Fe({vertexShader:Nt,fragmentShader:Ft,uniforms:{time:{value:0},normalMap:{value:d},cameraPosition:{value:new h}},transparent:!0,side:Ye,depthWrite:!1}),this.mesh=new Q(s,this.material),this.mesh.rotation.x=-Math.PI/2,this.mesh.position.y=i,n.add(this.mesh)}createNormalMap(){const o=new Uint8Array(65536);for(let i=0;i<128;i++)for(let s=0;s<128;s++){const d=(i*128+s)*4,r=Math.sin(i*.1)*.5+.5,u=Math.cos(s*.1)*.5+.5,p=1;o[d]=r*255,o[d+1]=u*255,o[d+2]=p*255,o[d+3]=255}const e=new bt(o,128,128,wt);return e.wrapS=ke,e.wrapT=ke,e.needsUpdate=!0,e}update(n,o){this.material.uniforms.time.value=n,this.material.uniforms.cameraPosition.value.copy(o)}}var _t=`attribute float size;
attribute float speed;
attribute float offset;

varying float vAlpha;

uniform float time;

void main() {
  vec3 pos = position;
  
  float totalTime = time * speed + offset;
  pos.y = mod(totalTime, 10.0) - 5.0;
  
  float wiggle = sin(totalTime * 2.0) * 0.1;
  pos.x += wiggle;
  
  vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
  gl_Position = projectionMatrix * mvPosition;
  
  gl_PointSize = size * (300.0 / -mvPosition.z);
  
  vAlpha = 1.0 - smoothstep(-3.0, 3.0, pos.y);
}`,Ht=`varying float vAlpha;

void main() {
  vec2 center = gl_PointCoord - vec2(0.5);
  float dist = length(center);
  
  if (dist > 0.5) {
    discard;
  }
  
  float alpha = smoothstep(0.5, 0.3, dist) * vAlpha * 0.6;
  vec3 color = vec3(0.8, 0.9, 1.0);
  
  float highlight = smoothstep(0.4, 0.2, dist);
  color += vec3(highlight) * 0.3;
  
  gl_FragColor = vec4(color, alpha);
}`;class Ut{constructor(n,o){c(this,"points");c(this,"material");c(this,"count");this.count=50;const e=new je,i=new Float32Array(this.count*3),s=new Float32Array(this.count),d=new Float32Array(this.count),r=new Float32Array(this.count),u=new h;o.getSize(u);const p=new h;o.getCenter(p);for(let f=0;f<this.count;f++)i[f*3]=p.x+(Math.random()-.5)*u.x*.8,i[f*3+1]=o.min.y+Math.random()*u.y,i[f*3+2]=p.z+(Math.random()-.5)*u.z*.8,s[f]=Math.random()*3+1,d[f]=Math.random()*.5+.2,r[f]=Math.random()*10;e.setAttribute("position",new V(i,3)),e.setAttribute("size",new V(s,1)),e.setAttribute("speed",new V(d,1)),e.setAttribute("offset",new V(r,1)),this.material=new Fe({vertexShader:_t,fragmentShader:Ht,uniforms:{time:{value:0}},transparent:!0,blending:Mt,depthWrite:!1}),this.points=new Et(e,this.material),n.add(this.points)}update(n){this.material.uniforms.time.value=n}setEnabled(n){this.points.visible=n}}class Wt{constructor(n){c(this,"scene");c(this,"camera");c(this,"renderer");c(this,"controls");c(this,"clock");c(this,"tank");c(this,"fishSystem",null);c(this,"waterSurface",null);c(this,"bubbleSystem",null);c(this,"animationId",null);c(this,"motionEnabled",!0);c(this,"animate",()=>{if(!this.motionEnabled){this.animationId=requestAnimationFrame(this.animate);return}this.animationId=requestAnimationFrame(this.animate);const n=this.clock.getDelta(),o=this.clock.getElapsedTime();this.controls.update(),this.fishSystem&&this.fishSystem.update(n,o),this.waterSurface&&this.waterSurface.update(o,this.camera.position),this.bubbleSystem&&this.bubbleSystem.update(o),this.renderer.render(this.scene,this.camera)});c(this,"handleResize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)});this.scene=new vt,this.clock=new St,this.camera=new xt(45,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,5,15),this.renderer=new Pt({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.toneMapping=Tt,this.renderer.toneMappingExposure=1.2,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=kt,n.appendChild(this.renderer.domElement),this.controls=new Ct(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.minDistance=5,this.controls.maxDistance=30,this.controls.maxPolarAngle=Math.PI*.8,this.tank=new Re,this.scene.add(this.tank),this.setupLighting(),this.createTank(),this.createFishSystem(),this.createWaterEffects(),this.setupEventListeners()}setupLighting(){const n=new At(6997974,.4);this.scene.add(n);const o=new Lt(16777215,.8);o.position.set(5,10,5),o.castShadow=!0,o.shadow.camera.near=.1,o.shadow.camera.far=50,o.shadow.camera.left=-10,o.shadow.camera.right=10,o.shadow.camera.top=10,o.shadow.camera.bottom=-10,o.shadow.mapSize.width=2048,o.shadow.mapSize.height=2048,this.scene.add(o);const e=new Ae(6997974,.5,20);e.position.set(-5,3,-5),this.scene.add(e);const i=new Ae(4890290,.5,20);i.position.set(5,3,5),this.scene.add(i)}createTank(){const s=new zt({color:16777215,metalness:0,roughness:0,transmission:.95,thickness:.05,transparent:!0,opacity:.3,reflectivity:.5,ior:1.5,side:Ye}),d=new Le(10,6,8,1,1,1),r=new Q(d,s);r.castShadow=!0,r.receiveShadow=!0,this.tank.add(r);const u=new Le(10-.05*2,.2,8-.05*2),p=new ze({color:2772314,roughness:.8,metalness:.1}),f=new Q(u,p);f.position.y=-6/2+.1,f.receiveShadow=!0,this.tank.add(f);const v=new Ne(10-.05*2,8-.05*2),S=new ze({color:15259064,roughness:1,metalness:0,normalScale:new M(.5,.5)}),E=new Q(v,S);E.rotation.x=-Math.PI/2,E.position.y=-6/2+.21,E.receiveShadow=!0,this.tank.add(E)}createFishSystem(){const n=new Oe(new h(-4.5,-2.5,-3.5),new h(4.5,2.5,3.5));this.fishSystem=new jt(this.scene,n)}createWaterEffects(){this.waterSurface=new Yt(this.scene,10,8,2.8);const n=new Oe(new h(-4.5,-2.5,-3.5),new h(4.5,2.5,3.5));this.bubbleSystem=new Ut(this.scene,n)}start(){this.animate()}stop(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null)}setMotionEnabled(n){this.motionEnabled=n,this.fishSystem&&this.fishSystem.setMotionEnabled(n),this.bubbleSystem&&this.bubbleSystem.setEnabled(n)}setupEventListeners(){window.addEventListener("resize",this.handleResize)}dispose(){this.stop(),window.removeEventListener("resize",this.handleResize),this.renderer.dispose(),this.controls.dispose()}}class Bt{constructor(){c(this,"scene",null);c(this,"audioElement");c(this,"motionToggle");c(this,"soundToggle");c(this,"prefersReducedMotion");this.audioElement=document.getElementById("water-sound"),this.motionToggle=document.getElementById("motion-toggle"),this.soundToggle=document.getElementById("sound-toggle"),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.init()}async init(){this.showLoadingScreen(),await this.loadAssets();const n=document.getElementById("canvas-container");n&&(this.scene=new Wt(n),this.setupEventListeners(),this.prefersReducedMotion&&(this.motionToggle.checked=!1,this.scene.setMotionEnabled(!1)),this.scene.start(),setTimeout(()=>{this.hideLoadingScreen()},2e3))}showLoadingScreen(){const n=document.getElementById("lottie-bubbles");if(!n)return;const o={container:n,renderer:"svg",loop:!0,autoplay:!0,animationData:{v:"5.5.7",fr:30,ip:0,op:60,w:200,h:200,nm:"Bubbles",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"Bubble 1",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:1,k:[{i:{x:.5,y:1},o:{x:.5,y:0},t:0,s:[100,180,0],to:[0,-30,0],ti:[0,30,0]},{t:60,s:[100,20,0]}]},a:{a:0,k:[0,0,0]},s:{a:0,k:[100,100,100]}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"el",s:{a:0,k:[20,20]},p:{a:0,k:[0,0]}},{ty:"st",c:{a:0,k:[.42,.78,.84,1]},o:{a:0,k:100},w:{a:0,k:2}},{ty:"fl",c:{a:0,k:[.42,.78,.84,.3]},o:{a:0,k:30}},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100}}]}],ip:0,op:60,st:0}]}};Ot.loadAnimation(o)}hideLoadingScreen(){const n=document.getElementById("loading-screen");n&&(n.style.transition="opacity 0.5s",n.style.opacity="0",setTimeout(()=>{n.style.display="none"},500))}async loadAssets(){return new Promise(n=>{setTimeout(n,1e3)})}setupEventListeners(){this.motionToggle.addEventListener("change",()=>{this.scene&&this.scene.setMotionEnabled(this.motionToggle.checked)}),this.soundToggle.addEventListener("change",()=>{this.soundToggle.checked?(this.audioElement.volume=.2,this.audioElement.play().catch(n=>{console.error("Audio play failed:",n),this.soundToggle.checked=!1})):this.audioElement.pause()}),window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",n=>{n.matches&&(this.motionToggle.checked=!1,this.scene&&this.scene.setMotionEnabled(!1))})}}document.addEventListener("DOMContentLoaded",()=>{new Bt});
